<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Create account form template
 *
 * @see app/design/frontend/base/default/template/customer/form/register.phtml
 */
/** @var $this Mage_Customer_Block_Form_Register */
?>
<?php $data = $this->getRequest()->getPost(); ?>
<div class="account-create">
    <div class="page-title">
        <h1><?php echo $this->__('法人アカウントを登録する') ?></h1>
    </div>
    <?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
    <form action="<?php echo $this->getPostActionUrl() ?>" method="post" id="form-validate">
        <div class="fieldset">
            <ul class="form-list">
            	<input type="hidden" name="success_url" value="<?php echo $this->getSuccessUrl() ?>" />
           		<input type="hidden" name="error_url" value="<?php echo $this->getErrorUrl() ?>" />
           		<li>
           			<?php echo $this->__('＊＝必須') ?>
           		</li>
                <li id="company-logo">
                	<div class="company-logo<?php echo ($this->getFormData()->getCompanyLogo()) ? ' after-input' : '' ?>">
                		<?php if($this->getFormData()->getCompanyLogo()): ?>
                			<img alt="" src="<?php echo Mage::helper('job')->getUrl().'media/logo/'.$this->getFormData()->getCompanyLogo() ?>" />
                		<?php else: ?>
                			<p><?php echo $this->__('COMPANY LOGO') ?></p>
                		<?php endif; ?>
                		
                	</div>
                	<a href="#" id="browse"><?php echo $this->__('Browse') ?></a>
                	<input id="upload-input" type="file" name="file" data-url="<?php echo Mage::getBaseUrl() ?>client/index/upload">
                	<input id="logo-file-name" type="hidden" name="company_logo" value="<?php echo $this->getFormData()->getCompanyLogo() ?>" />
                </li>
                <li>
                	<input <?php echo ($this->getFormData()->getCompanyName()) ? 'class="after-input"' : '' ?> required type="text" name="company_name" placeholder="<?php echo $this->__('企業名') ?> *" value="<?php echo $this->getFormData()->getCompanyName() ?>" />
                </li>
                <li>
                	<input <?php echo ($this->getFormData()->getCompanyAddress()) ? 'class="after-input"' : '' ?> required type="text" name="company_address" placeholder="<?php echo $this->__('所在地') ?> *" value="<?php echo $this->getFormData()->getCompanyAddress() ?>" />
                </li>
                <li>
                	<input required type="password" name="password" placeholder="<?php echo $this->__('パスワード') ?> *" />
                </li>
                <li>
                	<input required type="password" name="confirmation" placeholder="<?php echo $this->__('確認（パスワード）') ?> *" />
                </li>
                <li>
                	<select <?php echo ($this->getFormData()->getCompanySize()) ? 'class="after-input"' : '' ?> name="company_size">
                		<option value=""><?php echo $this->__('企業規模') ?></option>
                		<option <?php echo ($this->getFormData()->getCompanySize() == '1') ? 'selected="selected"' : '' ?> value="1"><?php echo $this->__('Less than 10') ?></option>
                		<option <?php echo ($this->getFormData()->getCompanySize() == '2') ? 'selected="selected"' : '' ?> value="2"><?php echo $this->__('10-24') ?></option>
                		<option <?php echo ($this->getFormData()->getCompanySize() == '3') ? 'selected="selected"' : '' ?> value="3"><?php echo $this->__('25-99') ?></option>
                		<option <?php echo ($this->getFormData()->getCompanySize() == '4') ? 'selected="selected"' : '' ?> value="4"><?php echo $this->__('100-500') ?></option>
                		<option <?php echo ($this->getFormData()->getCompanySize() == '5') ? 'selected="selected"' : '' ?> value="5"><?php echo $this->__('More than 500') ?></option>
                	</select>
                </li>
                <li>
                	<input <?php echo ($this->getFormData()->getCompanyWebsite()) ? 'class="after-input"' : '' ?> type="url" name="company_website" placeholder="<?php echo $this->__('ウェブサイト') ?>" value="<?php echo $this->getFormData()->getCompanyWebsite() ?>" />
                </li>
                <li>
                	<textarea <?php echo ($this->getFormData()->getCompanyDetail()) ? 'class="after-input"' : '' ?> placeholder="<?php echo $this->__('企業情報') ?> *" name="company_detail" required><?php echo $this->getFormData()->getCompanyDetail() ?></textarea>
                </li>
                <li>
                	<input <?php echo ($this->getFormData()->getFirstname()) ? 'class="after-input"' : '' ?> required type="text" name="firstname" placeholder="<?php echo $this->__('担当者') ?> *" value="<?php echo $this->getFormData()->getFirstname() ?>" />
                </li>
                <li>
                	<input <?php echo ($this->getFormData()->getEmail()) ? 'class="after-input"' : '' ?> required type="email" name="email" placeholder="<?php echo $this->__('Email') ?> *" value="<?php echo $this->getFormData()->getEmail() ?>" />
                </li>
                <li>
                	<input name="agree" required type="radio" value="1" />
                	<?php echo $this->__('アイコニックの <a target="_blank" href="%s">個人情報保護方針</a> に同意する。', Mage::helper('job')->getUrl().'privacy-policy') ?>
                </li>
            </ul>
        </div>
        <div class="buttons-set">
            <button type="submit" title="<?php echo $this->__('この内容で登録する') ?>" class="btn button"><?php echo $this->__('この内容で登録する') ?></button>
        </div>
    </form>
</div>
<script>
	jQuery(document).ready(function(){
		jQuery('#browse').click(function(){
			jQuery('#upload-input').click();
		});
	});
</script>
<script src="<?php echo Mage::helper('job')->getUrl() ?>js/fileupload/vendor/jquery.ui.widget.js"></script>
<script src="<?php echo Mage::helper('job')->getUrl() ?>js/fileupload/jquery.iframe-transport.js"></script>
<script src="<?php echo Mage::helper('job')->getUrl() ?>js/fileupload/jquery.fileupload.js"></script>
<script>
(function($){
	$(function () {
	    $('#upload-input').fileupload({
	        dataType: 'json',
	        beforeSend: function () {
		    	var loading = '<img alt="" src="'+ '<?php echo Mage::helper('job')->getUrl().'skin/frontend/default/iconic/images/loading.gif' ?>' +'" />';
		        $('#company-logo .company-logo').html(loading).fadeIn();
	        },
	        done: function (e, data) {
	            if(!data.result.error){
		            $.each(data.result.files, function (index, file) {
	            		$('#logo-file-name').val(file);
	            		var img = '<img alt="" src="'+ '<?php echo Mage::helper('job')->getUrl().'media/logo/' ?>' + file +'" />';
	            		$('#company-logo .company-logo').addClass('after-input').html(img).fadeIn();
		            });
		        }else{
		        	var text = '<p>COMPANY LOGO</p>';
                	$('#company-logo .company-logo').html(text);
                	alert(data.result.error);
                }
	            $('#upload-input').val('');
	        }
	    });
	    
	});
})(jQuery);
</script>